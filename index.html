<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="MediTech - Découvrez les technologies médicales avancées pour toutes les spécialités médicales.">
    <meta name="keywords" content="technologies médicales, équipements médicaux, santé, diagnostic, thérapie">
    <meta name="author" content="MediTech">
    <meta property="og:title" content="MediTech - Votre Guide Biomédical">
    <meta property="og:description" content="Découvrez notre écosystème complet de technologies médicales de pointe.">
    <meta property="og:type" content="website">
    <title>MediTech - Votre Guide Biomédical</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            line-height: 1.6;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            overflow-x: hidden;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 100px 15px 20px 15px;
            min-height: 100vh;
            position: relative;
        }

        .header {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(20px);
            padding: 20px 25px;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            z-index: 100;
            text-align: center;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo-icon {
            font-size: 2.5rem;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .logo-text {
            font-size: 2.2rem;
            font-weight: 700;
            color: #2d3748;
        }

        .search-container {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .search-box {
            background: #f7fafc;
            border: 2px solid #e2e8f0;
            padding: 12px 20px;
            border-radius: 12px;
            width: 300px;
            font-size: 14px;
            font-family: 'Poppins', sans-serif;
            transition: all 0.3s ease;
        }

        .search-box:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .nav-breadcrumb {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 15px;
            font-size: 14px;
            color: #718096;
        }

        .nav-breadcrumb button {
            background: none;
            border: none;
            color: #667eea;
            cursor: pointer;
            text-decoration: none;
            font-size: 14px;
            font-family: 'Poppins', sans-serif;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .nav-breadcrumb button:hover {
            color: #764ba2;
        }

        .content-section {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            padding: 40px;
            border-radius: 25px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.1);
            border: 2px solid #d1d5db;
            min-height: 600px;
        }

        .content-section:not(.hidden) {
            animation: slideInUp 0.6s ease-out;
        }

        .content-section.hidden {
            animation: none;
            display: none;
        }

        .page-title {
            font-size: 3rem;
            color: #2d3748;
            margin-bottom: 20px;
            text-align: center;
            font-weight: 600;
        }

        .hero-section {
            text-align: center;
            margin-bottom: 50px;
        }

        .hero-section h2 {
            font-size: 2rem;
            color: #4a5568;
            margin-bottom: 25px;
            font-weight: 500;
        }

        .hero-section p {
            font-size: 1.2rem;
            color: #718096;
            margin-bottom: 35px;
            max-width: 700px;
            margin-left: auto;
            margin-right: auto;
            line-height: 1.8;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 18px 35px;
            border: none;
            border-radius: 12px;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
            font-family: 'Poppins', sans-serif;
            font-weight: 600;
            letter-spacing: 0.5px;
        }

        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 35px rgba(102, 126, 234, 0.4);
        }

        .services-grid, .devices-grid {
            display: grid;
            gap: 30px;
            margin-top: 40px;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        }

        .service-card, .device-card {
            background: white;
            backdrop-filter: blur(15px);
            padding: 35px;
            border-radius: 16px;
            cursor: pointer;
            transition: all 0.4s ease;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
            border: 1px solid #e2e8f0;
            position: relative;
            overflow: hidden;
            transform: translateZ(0);
        }

        .service-card:hover, .device-card:hover {
            transform: translateY(-10px) translateZ(20px);
            box-shadow: 0 20px 50px rgba(102, 126, 234, 0.15);
            border-color: #667eea;
        }

        .service-card:before, .device-card:before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(102, 126, 234, 0.05), transparent);
            transition: all 0.6s ease;
        }

        .service-card:hover:before, .device-card:hover:before {
            left: 100%;
        }

        .card-icon {
            font-size: 3.5rem;
            margin-bottom: 25px;
            text-align: center;
            color: #667eea;
        }

        .card-image, .device-image {
            width: 100%;
            height: 150px;
            background: #f7fafc;
            border-radius: 10px;
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            color: #cbd5e0;
            border: 2px solid #e2e8f0;
            object-fit: cover;
            transition: transform 0.3s ease;
        }

        .card-image:hover, .device-image:hover {
            transform: scale(1.1);
        }

        .device-image {
            height: 250px;
            max-width: 400px;
            margin: 30px auto;
        }

        .card-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 20px;
        }

        .card-description {
            color: #718096;
            line-height: 1.7;
            font-size: 1rem;
        }

        .device-details {
            max-width: 1000px;
            margin: 0 auto;
            color: #2d3748;
        }

        .device-info {
            background: #f7fafc;
            padding: 30px;
            border-radius: 15px;
            margin: 25px 0;
            border: 2px solid #e2e8f0;
        }

        .device-info h3 {
            color: #2d3748;
            margin-bottom: 20px;
            font-size: 1.4rem;
            font-weight: 600;
        }

        .device-info p, .device-info ul {
            color: #4a5568;
            line-height: 1.8;
        }

        .back-btn {
            background: #f7fafc;
            color: #4a5568;
            padding: 12px 25px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            cursor: pointer;
            margin-bottom: 25px;
            transition: all 0.3s ease;
            font-family: 'Poppins', sans-serif;
            font-weight: 500;
        }

        .back-btn:hover {
            background: #667eea;
            color: white;
            border-color: #667eea;
            transform: translateX(-5px);
        }

        .sort-section {
            margin-bottom: 30px;
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .sort-select {
            background: #f7fafc;
            border: 2px solid #e2e8f0;
            padding: 10px;
            border-radius: 10px;
            font-family: 'Poppins', sans-serif;
        }

        .sort-select:focus {
            outline: none;
            border-color: #667eea;
        }

        .footer {
            background: #ffffff;
            color: #2d3748;
            padding: 20px;
            border-radius: 20px;
            border: 1px solid #e2e8f0;
            text-align: center;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.05);
        }

        .footer a {
            color: #667eea;
            text-decoration: none;
            margin: 0 10px;
            position: relative;
            transition: all 0.3s ease;
        }

        .footer a:hover {
            color: #764ba2;
            text-decoration: none;
        }

        .footer a::after {
            content: '';
            position: absolute;
            width: 0;
            height: 2px;
            bottom: -2px;
            left: 0;
            background-color: #764ba2;
            transition: width 0.3s ease;
        }

        .footer a:hover::after {
            width: 100%;
        }

        .chatbot-toggle {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #667eea;
            color: white;
            padding: 15px;
            border-radius: 50%;
            cursor: pointer;
            z-index: 150;
            font-size: 1.5rem;
            border: 3px solid #667eea;
            transition: all 0.3s ease;
        }

        .chatbot-toggle:hover {
            background: #764ba2;
            border-color: #764ba2;
            transform: scale(1.1);
        }

        .chatbot-container {
            display: none;
            position: fixed;
            bottom: 80px;
            right: 20px;
            width: 350px;
            max-height: 500px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            z-index: 200;
            overflow: hidden;
        }

        .chatbot-header {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 15px;
            font-size: 1.2rem;
            font-weight: 600;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .chatbot-close {
            cursor: pointer;
            font-size: 1.5rem;
        }

        .chatbot-body {
            padding: 15px;
            max-height: 400px;
            overflow-y: auto;
        }

        .chat-message {
            margin-bottom: 15px;
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .chat-message.user {
            align-items: flex-end;
        }

        .chat-message.bot {
            align-items: flex-start;
        }

        .chat-message p {
            max-width: 80%;
            padding: 10px 15px;
            border-radius: 10px;
            font-size: 0.9rem;
        }

        .chat-message.user p {
            background: #667eea;
            color: white;
        }

        .chat-message.bot p {
            background: #f7fafc;
            color: #2d3748;
            border: 1px solid #e2e8f0;
        }

        .chatbot-input {
            display: flex;
            padding: 10px;
            background: #f7fafc;
            border-top: 1px solid #e2e8f0;
        }

        .chatbot-input input {
            flex: 1;
            padding: 10px;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            font-family: 'Poppins', sans-serif;
            font-size: 0.9rem;
        }

        .chatbot-input input:focus {
            outline: none;
            border-color: #667eea;
        }

        .chatbot-input button {
            background: #667eea;
            color: white;
            border: 3px solid #667eea;
            padding: 10px 15px;
            border-radius: 10px;
            margin-left: 10px;
            cursor: pointer;
            font-family: 'Poppins', sans-serif;
            transition: all 0.3s ease;
        }

        .chatbot-input button:hover {
            background: #764ba2;
            border-color: #764ba2;
        }

        .chatbot-typing {
            display: none;
            font-size: 0.9rem;
            color: #718096;
            padding: 10px;
        }

        .chatbot-typing span {
            animation: blink 0.5s infinite;
        }

        .chatbot-typing span:nth-child(2) {
            animation-delay: 0.2s;
        }

        .chatbot-typing span:nth-child(3) {
            animation-delay: 0.4s;
        }

        .chatbot-suggestions {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 10px;
        }

        .suggestion-btn {
            background: #e2e8f0;
            color: #2d3748;
            padding: 8px 15px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }

        .suggestion-btn:hover {
            background: #667eea;
            color: white;
        }

        .stats-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 25px;
            margin: 40px 0;
        }

        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            border: 2px solid #e2e8f0;
            transition: transform 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: 700;
            color: #667eea;
            margin-bottom: 10px;
        }

        .stat-label {
            color: #718096;
            font-size: 1rem;
        }

        .image-error {
            background: #f7fafc;
            color: #718096;
            text-align: center;
            padding: 10px;
            border-radius: 10px;
            font-size: 0.9rem;
        }

        @media (max-width: 768px) {
            .container {
                padding: 80px 15px 20px 15px;
            }

            .content-section {
                padding: 25px;
            }

            .page-title {
                font-size: 2rem;
            }

            .header-content {
                flex-direction: column;
                gap: 20px;
            }

            .search-box {
                width: 100%;
            }

            .sort-section {
                flex-direction: column;
            }

            .chatbot-container {
                width: 90%;
                bottom: 70px;
            }
        }

        @keyframes slideInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0; }
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <div class="header-content">
                <div class="logo">
                    <div class="logo-icon" aria-label="MediTech Logo">🏥</div>
                    <div class="logo-text">MediTech</div>
                </div>
                <div class="search-container">
                    <input type="text" class="search-box" placeholder="Rechercher des dispositifs médicaux..." id="searchBox" aria-label="Recherche de dispositifs médicaux">
                </div>
            </div>
            <nav class="nav-breadcrumb" id="breadcrumb" aria-label="Fil d'ariane"></nav>
        </header>

        <main>
            <section id="home-page" class="content-section">
                <h1 class="page-title">Technologies Médicales Avancées</h1>
                <div class="hero-section">
                    <h2>L'Innovation au Service de la Médecine</h2>
                    <p>Découvrez notre écosystème complet de technologies médicales de pointe. Des équipements diagnostiques aux systèmes thérapeutiques les plus avancés, nous proposons des solutions innovantes pour tous les secteurs de la médecine moderne.</p>
                    <button class="btn-primary" id="exploreServicesBtn" aria-label="Explorer les services" role="button">Explorer nos Services</button>
                </div>

                <div class="stats-section">
                    <div class="stat-card">
                        <div class="stat-number" id="deviceCount"></div>
                        <div class="stat-label">Dispositifs</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">8</div>
                        <div class="stat-label">Spécialités</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">98%</div>
                        <div class="stat-label">Satisfaction</div>
                    </div>
                </div>
            </section>

            <section id="services-page" class="content-section hidden">
                <button class="back-btn" id="homeBackBtn" aria-label="Retour à l'accueil" role="button">← Retour à l'accueil</button>
                <h1 class="page-title">Spécialités Médicales</h1>
                <div class="services-grid" id="servicesGrid">
                    <div class="service-card" data-service="pediatrie">
                        <div class="card-icon" aria-hidden="true">👶</div>
                        <div class="card-content">
                            <h3 class="card-title">Pédiatrie</h3>
                            <p class="card-description">Équipements spécialisés pour le diagnostic et le traitement des enfants et nourrissons. Technologies adaptées aux besoins spécifiques de la médecine pédiatrique.</p>
                            <ul style="margin-top: 15px; color: #718096;">
                                <li>Échographes pédiatriques</li>
                                <li>Moniteurs néonataux</li>
                                <li>Ventilateurs adaptés</li>
                            </ul>
                        </div>
                    </div>
                    <div class="service-card" data-service="cardiologie">
                        <div class="card-icon" aria-hidden="true">❤️</div>
                        <div class="card-content">
                            <h3 class="card-title">Cardiologie</h3>
                            <p class="card-description">Dispositifs avancés pour l'exploration et le traitement des pathologies cardiovasculaires. Technologies de pointe pour un diagnostic précis.</p>
                            <ul style="margin-top: 15px; color: #718096;">
                                <li>Électrocardiographes</li>
                                <li>Échocardiographes</li>
                                <li>Holters et défibrillateurs</li>
                            </ul>
                        </div>
                    </div>
                    <div class="service-card" data-service="radiologie">
                        <div class="card-icon" aria-hidden="true">📡</div>
                        <div class="card-content">
                            <h3 class="card-title">Radiologie</h3>
                            <p class="card-description">Technologies d'imagerie médicale pour un diagnostic précis et non invasif. Solutions complètes d'imagerie diagnostique.</p>
                            <ul style="margin-top: 15px; color: #718096;">
                                <li>Scanners haute résolution</li>
                                <li>IRM 3 Tesla</li>
                                <li>Mammographie numérique</li>
                            </ul>
                        </div>
                    </div>
                    <div class="service-card" data-service="neurologie">
                        <div class="card-icon" aria-hidden="true">🧠</div>
                        <div class="card-content">
                            <h3 class="card-title">Neurologie</h3>
                            <p class="card-description">Équipements spécialisés pour l'étude du système nerveux central et périphérique. Diagnostic neurologique avancé.</p>
                            <ul style="margin-top: 15px; color: #718096;">
                                <li>Électroencéphalographes</li>
                                <li>Scanner cérébral</li>
                                <li>Doppler transcrânien</li>
                            </ul>
                        </div>
                    </div>
                    <div class="service-card" data-service="orthopédie">
                        <div class="card-icon" aria-hidden="true">🦴</div>
                        <div class="card-content">
                            <h3 class="card-title">Orthopédie</h3>
                            <p class="card-description">Dispositifs pour le diagnostic et le traitement des troubles musculo-squelettiques. Imagerie et thérapie osseuse.</p>
                            <ul style="margin-top: 15px; color: #718096;">
                                <li>Radiographie osseuse</li>
                                <li>Arthroscopes</li>
                                <li>Densitométrie osseuse</li>
                            </ul>
                        </div>
                    </div>
                    <div class="service-card" data-service="gastroentérologie">
                        <div class="card-icon" aria-hidden="true">🔬</div>
                        <div class="card-content">
                            <h3 class="card-title">Gastro-entérologie</h3>
                            <p class="card-description">Équipements pour l'exploration du système digestif et des organes associés. Endoscopie et imagerie digestive.</p>
                            <ul style="margin-top: 15px; color: #718096;">
                                <li>Endoscopie avancée</li>
                                <li>Coloscopie haute définition</li>
                                <li>pH-métrie 24h</li>
                            </ul>
                        </div>
                    </div>
                    <div class="service-card" data-service="oncologie">
                        <div class="card-icon" aria-hidden="true">🎗️</div>
                        <div class="card-content">
                            <h3 class="card-title">Oncologie</h3>
                            <p class="card-description">Technologies pour le diagnostic et le traitement des cancers. Solutions avancées pour l'imagerie et la thérapie oncologique.</p>
                            <ul style="margin-top: 15px; color: #718096;">
                                <li>PET Scanner</li>
                                <li>Radiothérapie Linac</li>
                            </ul>
                        </div>
                    </div>
                    <div class="service-card" data-service="urgences">
                        <div class="card-icon" aria-hidden="true">🚑</div>
                        <div class="card-content">
                            <h3 class="card-title">Urgences</h3>
                            <p class="card-description">Équipements pour les soins d'urgence et la réanimation. Technologies pour une intervention rapide et efficace.</p>
                            <ul style="margin-top: 15px; color: #718096;">
                                <li>Défibrillateurs automatiques</li>
                                <li>Ventilateurs d'urgence</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </section>

            <section id="devices-page" class="content-section hidden">
                <button class="back-btn" id="servicesBackBtn" aria-label="Retour aux services" role="button">← Retour aux services</button>
                <h1 class="page-title" id="devicesTitle">Dispositifs Médicaux</h1>
                <div class="sort-section">
                    <select class="sort-select" id="sortSelect" aria-label="Trier les dispositifs">
                        <option value="name-asc">Nom (A-Z)</option>
                        <option value="name-desc">Nom (Z-A)</option>
                    </select>
                </div>
                <div class="devices-grid" id="devicesGrid" aria-live="polite"></div>
            </section>

            <section id="device-details-page" class="content-section hidden">
                <button class="back-btn" id="devicesBackBtn" aria-label="Retour aux dispositifs" role="button">← Retour aux dispositifs</button>
                <div class="device-details" id="deviceDetailsContent"></div>
            </section>

            <button class="chatbot-toggle" id="chatbotToggle" aria-label="Ouvrir le chatbot" role="button">💬</button>
            <div class="chatbot-container" id="chatbotContainer">
                <div class="chatbot-header">
                    <span>MediTech Assistant</span>
                    <span class="chatbot-close" id="chatbotClose" aria-label="Fermer le chatbot" role="button">×</span>
                </div>
                <div class="chatbot-body" id="chatbotBody">
                    <div class="chatbot-typing" id="chatbotTyping">
                        <span>.</span><span>.</span><span>.</span>
                    </div>
                </div>
                <div class="chatbot-input">
                    <input type="text" id="chatbotInput" placeholder="Posez une question..." aria-label="Saisir une question pour le chatbot">
                    <button id="chatbotSend" aria-label="Envoyer la question" role="button">➤</button>
                </div>
            </div>

            <footer class="footer">
                <p>© 2025 MediTech. Tous droits réservés.</p>
                <p>
                    <a href="mailto:info@meditech.com">info@meditech.com</a> 
                    <a href="tel:+33123456789">+33 1 23 45 67 89</a>
                </p>
            </footer>
        </main>
    </div>

    <script>
        let currentService = '';
        let currentDevice = '';
        let chatHistory = [];

        const devices = {
            pediatrie: [
                { 
                    name: 'Échographe Pédiatrique', 
                    image: 'https://raw.githubusercontent.com/Douha03/MediTech_Guide/main/assets/images/ecoped.png', 
                    role: 'Diagnostic par imagerie pour enfants et nourrissons.',
                    principle: 'Utilise des ultrasons pour produire des images des organes internes en temps réel.',
                    components: ['Sonde à ultrasons', 'Écran Full HD', 'Système de traitement d\'image', 'Clavier de commande'],
                    maintenance: ['Vérifier l\'état de la sonde', 'Nettoyer l\'écran et le clavier', 'Calibrer le système mensuellement', 'Mettre à jour le logiciel'],
                    brands: ['Philips Healthcare', 'GE Healthcare']
                },
                { 
                    name: 'Moniteur Néonatal', 
                    image: 'https://via.placeholder.com/400x250?text=Moniteur+Néonatal', 
                    role: 'Surveillance continue des paramètres vitaux des nouveau-nés.',
                    principle: 'Mesure et affiche les signaux vitaux comme le rythme cardiaque et la saturation en oxygène.',
                    components: ['Capteurs SpO2', 'Électrodes ECG', 'Écran tactile', 'Système d\'alarme'],
                    maintenance: ['Vérifier les capteurs quotidiennement', 'Nettoyer les électrodes', 'Tester les alarmes', 'Remplacer la batterie si nécessaire'],
                    brands: ['GE Healthcare', 'Dräger']
                }
            ],
            cardiologie: [
                { 
                    name: 'Électrocardiographe', 
                    image: 'https://via.placeholder.com/400x250?text=ECG', 
                    role: 'Diagnostic des anomalies cardiaques par enregistrement électrique.',
                    principle: 'Enregistre l\'activité électrique du cœur via des électrodes placées sur la peau.',
                    components: ['Électrodes', 'Câbles de dérivation', 'Imprimante thermique', 'Écran LCD'],
                    maintenance: ['Vérifier les électrodes', 'Nettoyer les câbles', 'Tester l\'imprimante', 'Calibrer l\'appareil'],
                    brands: ['Mortara Instruments', 'Philips Healthcare']
                },
                { 
                    name: 'Échocardiographe', 
                    image: 'https://via.placeholder.com/400x250?text=Échocardiographe', 
                    role: 'Imagerie du cœur pour évaluer sa structure et sa fonction.',
                    principle: 'Utilise des ultrasons pour visualiser le cœur et les flux sanguins.',
                    components: ['Sonde à ultrasons', 'Écran 4K', 'Système Doppler', 'Logiciel d\'analyse'],
                    maintenance: ['Inspecter la sonde', 'Nettoyer l\'écran', 'Vérifier le logiciel', 'Calibrer le Doppler'],
                    brands: ['Siemens Healthineers', 'Philips Healthcare']
                }
            ],
            radiologie: [
                { 
                    name: 'Scanner', 
                    image: 'https://via.placeholder.com/400x250?text=Scanner', 
                    role: 'Imagerie par tomodensitométrie pour diagnostics détaillés.',
                    principle: 'Utilise des rayons X pour créer des images en coupes des organes.',
                    components: ['Tube à rayons X', 'Détecteurs', 'Table d\'examen', 'Console de traitement'],
                    maintenance: ['Vérifier le tube à rayons X', 'Nettoyer la table', 'Calibrer les détecteurs', 'Mettre à jour le logiciel'],
                    brands: ['Canon Medical', 'Siemens Healthineers']
                },
                { 
                    name: 'IRM', 
                    image: 'https://via.placeholder.com/400x250?text=IRM', 
                    role: 'Imagerie par résonance magnétique pour diagnostics non invasifs.',
                    principle: 'Utilise des champs magnétiques et des ondes radio pour produire des images détaillées.',
                    components: ['Aimant principal', 'Bobines RF', 'Table d\'examen', 'Système de refroidissement'],
                    maintenance: ['Vérifier le système de refroidissement', 'Inspecter les bobines', 'Calibrer l\'aimant', 'Tester les sécurités'],
                    brands: ['Philips Healthcare', 'Siemens Healthineers']
                }
            ],
            neurologie: [
                { 
                    name: 'Électroencéphalographe', 
                    image: 'https://via.placeholder.com/400x250?text=EEG', 
                    role: 'Analyse de l\'activité électrique du cerveau.',
                    principle: 'Enregistre les signaux électriques via des électrodes sur le cuir chevelu.',
                    components: ['Électrodes EEG', 'Amplificateur', 'Écran d\'analyse', 'Logiciel de traitement'],
                    maintenance: ['Vérifier les électrodes', 'Nettoyer l\'amplificateur', 'Tester le logiciel', 'Calibrer l\'appareil'],
                    brands: ['Nihon Kohden', 'Philips Healthcare']
                }
            ],
            orthopédie: [
                { 
                    name: 'Densitomètre Osseux', 
                    image: 'https://via.placeholder.com/400x250?text=DEXA', 
                    role: 'Mesure de la densité minérale osseuse pour diagnostiquer l\'ostéoporose.',
                    principle: 'Utilise des rayons X à double énergie pour évaluer la densité osseuse.',
                    components: ['Source de rayons X', 'Détecteur DEXA', 'Table de scan', 'Logiciel d\'analyse'],
                    maintenance: ['Vérifier la source de rayons X', 'Nettoyer la table', 'Calibrer le détecteur', 'Mettre à jour le logiciel'],
                    brands: ['Hologic Inc', 'GE Healthcare']
                }
            ],
            gastroentérologie: [
                { 
                    name: 'Coloscope', 
                    image: 'https://via.placeholder.com/400x250?text=Coloscope', 
                    role: 'Exploration visuelle du côlon pour dépistage et diagnostic.',
                    principle: 'Utilise une caméra flexible pour visualiser l\'intérieur du côlon.',
                    components: ['Endoscope flexible', 'Caméra HD', 'Source lumineuse', 'Système de contrôle'],
                    maintenance: ['Désinfecter l\'endoscope', 'Vérifier la caméra', 'Tester la source lumineuse', 'Inspecter les canaux'],
                    brands: ['Olympus Medical', 'Fujifilm']
                }
            ],
            oncologie: [
                { 
                    name: 'PET Scanner', 
                    image: 'https://via.placeholder.com/400x250?text=PET+Scanner', 
                    role: 'Imagerie pour le diagnostic et le suivi des cancers.',
                    principle: 'Utilise des traceurs radioactifs pour détecter les anomalies métaboliques.',
                    components: ['Détecteurs de rayonnement', 'Table d\'examen', 'Système d\'injection', 'Console d\'analyse'],
                    maintenance: ['Vérifier les détecteurs', 'Calibrer le système d\'injection', 'Nettoyer la table', 'Mettre à jour le logiciel'],
                    brands: ['Siemens Healthineers', 'GE Healthcare']
                },
                { 
                    name: 'Radiothérapie Linac', 
                    image: 'https://via.placeholder.com/400x250?text=Linac', 
                    role: 'Traitement ciblé des tumeurs par rayonnement.',
                    principle: 'Délivre des faisceaux de rayonnement précis pour détruire les cellules cancéreuses.',
                    components: ['Accélérateur linéaire', 'Collimator', 'Table de traitement', 'Système de planification'],
                    maintenance: ['Vérifier le collimator', 'Calibrer l\'accélérateur', 'Inspecter la table', 'Tester le logiciel'],
                    brands: ['Varian Medical', 'Elekta']
                }
            ],
            urgences: [
                { 
                    name: 'Défibrillateur Automatique', 
                    image: 'https://via.placeholder.com/400x250?text=Défibrillateur', 
                    role: 'Restauration du rythme cardiaque en cas d\'arrêt cardiaque.',
                    principle: 'Délivre un choc électrique pour rétablir le rythme cardiaque normal.',
                    components: ['Électrodes', 'Batterie', 'Écran d\'interface', 'Système d\'analyse ECG'],
                    maintenance: ['Vérifier les électrodes', 'Tester la batterie', 'Calibrer l\'analyseur ECG', 'Mettre à jour le firmware'],
                    brands: ['Philips Healthcare', 'Zoll Medical']
                },
                { 
                    name: 'Ventilateur d\'Urgence', 
                    image: 'https://via.placeholder.com/400x250?text=Ventilateur', 
                    role: 'Support respiratoire pour les patients en détresse.',
                    principle: 'Fournit une ventilation mécanique pour assister ou remplacer la respiration.',
                    components: ['Circuit respiratoire', 'Écran de contrôle', 'Capteurs de pression', 'Système d\'alarme'],
                    maintenance: ['Nettoyer le circuit', 'Vérifier les capteurs', 'Tester les alarmes', 'Calibrer le système'],
                    brands: ['Dräger', 'Medtronic']
                }
            ]
        };

        const services = {
            pediatrie: {
                name: 'Pédiatrie',
                description: 'Équipements spécialisés pour le diagnostic et le traitement des enfants et nourrissons. Technologies adaptées aux besoins spécifiques de la médecine pédiatrique.',
                examples: ['Échographes pédiatriques', 'Moniteurs néonataux', 'Ventilateurs adaptés']
            },
            cardiologie: {
                name: 'Cardiologie',
                description: 'Dispositifs avancés pour l\'exploration et le traitement des pathologies cardiovasculaires. Technologies de pointe pour un diagnostic précis.',
                examples: ['Électrocardiographes', 'Échocardiographes', 'Holters et défibrillateurs']
            },
            radiologie: {
                name: 'Radiologie',
                description: 'Technologies d\'imagerie médicale pour un diagnostic précis et non invasif. Solutions complètes d\'imagerie diagnostique.',
                examples: ['Scanners haute résolution', 'IRM 3 Tesla', 'Mammographie numérique']
            },
            neurologie: {
                name: 'Neurologie',
                description: 'Équipements spécialisés pour l\'étude du système nerveux central et périphérique. Diagnostic neurologique avancé.',
                examples: ['Électroencéphalographes', 'Scanner cérébral', 'Doppler transcrânien']
            },
            orthopédie: {
                name: 'Orthopédie',
                description: 'Dispositifs pour le diagnostic et le traitement des troubles musculo-squelettiques. Imagerie et thérapie osseuse.',
                examples: ['Radiographie osseuse', 'Arthroscopes', 'Densitométrie osseuse']
            },
            gastroentérologie: {
                name: 'Gastro-entérologie',
                description: 'Équipements pour l\'exploration du système digestif et des organes associés. Endoscopie et imagerie digestive.',
                examples: ['Endoscopie avancée', 'Coloscopie haute définition', 'pH-métrie 24h']
            },
            oncologie: {
                name: 'Oncologie',
                description: 'Technologies pour le diagnostic et le traitement des cancers. Solutions avancées pour l\'imagerie et la thérapie oncologique.',
                examples: ['PET Scanner', 'Radiothérapie Linac']
            },
            urgences: {
                name: 'Urgences',
                description: 'Équipements pour les soins d\'urgence et la réanimation. Technologies pour une intervention rapide et efficace.',
                examples: ['Défibrillateurs automatiques', 'Ventilateurs d\'urgence']
            }
        };

        function hideAllPages() {
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.add('hidden');
                section.style.display = 'none';
            });
        }

        function updateBreadcrumb(items) {
            const breadcrumb = document.getElementById('breadcrumb');
            if (!breadcrumb) return;
            breadcrumb.innerHTML = '';
            items.forEach((item, index) => {
                const button = document.createElement('button');
                button.textContent = item.text;
                button.setAttribute('aria-label', item.text);
                button.onclick = item.action;
                breadcrumb.appendChild(button);
                if (index < items.length - 1) {
                    breadcrumb.appendChild(document.createTextNode(' > '));
                }
            });
        }

        function showHome() {
            hideAllPages();
            const homePage = document.getElementById('home-page');
            if (homePage) {
                homePage.classList.remove('hidden');
                homePage.style.display = 'block';
                homePage.style.opacity = '1';
            } else {
                console.error('home-page element not found');
            }
            updateBreadcrumb([]);
            updateStats();
        }

        function showServices() {
            hideAllPages();
            const servicesPage = document.getElementById('services-page');
            if (servicesPage) {
                servicesPage.classList.remove('hidden');
                servicesPage.style.display = 'block';
                servicesPage.style.opacity = '1';
            } else {
                console.error('services-page element not found');
                return;
            }
            updateBreadcrumb([{ text: 'Spécialités Médicales', action: showServices }]);
        }

        function showDevices(service) {
            if (!devices[service]) {
                const devicesGrid = document.getElementById('devicesGrid');
                if (devicesGrid) {
                    devicesGrid.innerHTML = '<p class="image-error">Aucun dispositif trouvé pour cette spécialité.</p>';
                }
                return;
            }

            currentService = service;
            hideAllPages();
            const devicesPage = document.getElementById('devices-page');
            const devicesTitle = document.getElementById('devicesTitle');
            const devicesGrid = document.getElementById('devicesGrid');
            
            if (!devicesPage || !devicesTitle || !devicesGrid) {
                console.error('devices-page or related elements not found');
                return;
            }

            devicesPage.classList.remove('hidden');
            devicesPage.style.display = 'block';
            devicesPage.style.opacity = '1';
            devicesTitle.textContent = `Dispositifs Médicaux - ${service.charAt(0).toUpperCase() + service.slice(1)}`;
            devicesGrid.innerHTML = '';
            
            const fragment = document.createDocumentFragment();
            sortDevices(devices[service]).forEach(device => {
                const card = createDeviceCard(device);
                fragment.appendChild(card);
            });
            devicesGrid.appendChild(fragment);
            
            updateBreadcrumb([
                { text: 'Spécialités Médicales', action: showServices },
                { text: service.charAt(0).toUpperCase() + service.slice(1), action: () => showDevices(service) }
            ]);
        }

        function showDeviceDetails(deviceName) {
            const device = findDeviceByName(deviceName);
            if (!device) {
                console.error(`Device ${deviceName} not found`);
                return;
            }
            
            currentDevice = deviceName;
            hideAllPages();
            const deviceDetailsPage = document.getElementById('device-details-page');
            const deviceDetailsContent = document.getElementById('deviceDetailsContent');
            
            if (!deviceDetailsPage || !deviceDetailsContent) {
                console.error('device-details-page or related elements not found');
                return;
            }

            deviceDetailsPage.classList.remove('hidden');
            deviceDetailsPage.style.display = 'block';
            deviceDetailsPage.style.opacity = '1';
            deviceDetailsContent.innerHTML = createDeviceDetailsHTML(device);
            
            updateBreadcrumb([
                { text: 'Spécialités Médicales', action: showServices },
                { text: currentService.charAt(0).toUpperCase() + currentService.slice(1), action: () => showDevices(currentService) },
                { text: device.name, action: () => showDeviceDetails(deviceName) }
            ]);
        }

        function findDeviceByName(name) {
            for (const service in devices) {
                const device = devices[service].find(d => d.name === name);
                if (device) return device;
            }
            return null;
        }

        function createDeviceCard(device) {
            const card = document.createElement('div');
            card.className = 'device-card';
            card.innerHTML = `
                <img src="${device.image}" alt="${device.name}" class="card-image" loading="lazy">
                <div class="card-content">
                    <h3 class="card-title">${device.name}</h3>
                </div>
            `;
            card.addEventListener('click', () => showDeviceDetails(device.name));
            return card;
        }

        function createDeviceDetailsHTML(device) {
            return `
                <h1 class="page-title">${device.name}</h1>
                <img src="${device.image}" alt="${device.name}" class="device-image" loading="lazy">
                
                <div class="device-info">
                    <h3>Rôle</h3>
                    <p>${device.role}</p>
                </div>

                <div class="device-info">
                    <h3>Principe de Fonctionnement</h3>
                    <p>${device.principle}</p>
                </div>

                <div class="device-info">
                    <h3>Composants Principaux</h3>
                    <ul>
                        ${device.components.map(component => `<li>${component}</li>`).join('')}
                    </ul>
                </div>

                <div class="device-info">
                    <h3>Checklist pour Maintenance Préventive</h3>
                    <ul>
                        ${device.maintenance.map(item => `<li>${item}</li>`).join('')}
                    </ul>
                </div>

                <div class="device-info">
                    <h3>Marques</h3>
                    <ul>
                        ${device.brands.map(brand => `<li>${brand}</li>`).join('')}
                    </ul>
                </div>
            `;
        }

        function updateStats() {
            const deviceCount = Object.values(devices).flat().length;
            const deviceCountElement = document.getElementById('deviceCount');
            if (deviceCountElement) {
                deviceCountElement.textContent = deviceCount;
            }
        }

        function sortDevices(deviceList) {
            const sortSelect = document.getElementById('sortSelect');
            if (!sortSelect) return deviceList;
            const sortValue = sortSelect.value;

            return [...deviceList].sort((a, b) => {
                if (sortValue === 'name-asc') {
                    return a.name.localeCompare(b.name);
                } else if (sortValue === 'name-desc') {
                    return b.name.localeCompare(a.name);
                }
                return 0;
            });
        }

        function addChatMessage(message, isUser, suggestions = []) {
            const chatbotBody = document.getElementById('chatbotBody');
            if (!chatbotBody) return;
            const messageDiv = document.createElement('div');
            messageDiv.className = `chat-message ${isUser ? 'user' : 'bot'}`;
            messageDiv.innerHTML = `<p>${message}</p>`;
            if (!isUser && suggestions.length > 0) {
                const suggestionsDiv = document.createElement('div');
                suggestionsDiv.className = 'chatbot-suggestions';
                suggestions.forEach(suggestion => {
                    const button = document.createElement('button');
                    button.className = 'suggestion-btn';
                    button.textContent = suggestion.text;
                    button.onclick = () => {
                        document.getElementById('chatbotInput').value = suggestion.query;
                        document.getElementById('chatbotSend').click();
                    };
                    suggestionsDiv.appendChild(button);
                });
                messageDiv.appendChild(suggestionsDiv);
            }
            chatbotBody.appendChild(messageDiv);
            chatbotBody.scrollTop = chatbotBody.scrollHeight;
        }

        function showTypingAnimation(show) {
            const typing = document.getElementById('chatbotTyping');
            if (typing) {
                typing.style.display = show ? 'block' : 'none';
            }
        }

        function processChatbotQuery(query) {
            const normalizedQuery = query.toLowerCase().trim();
            chatHistory.push({ query: normalizedQuery, timestamp: Date.now() });
            let response = 'Désolé, je n\'ai pas compris votre question. Pouvez-vous reformuler ou demander quelque chose sur les dispositifs, les marques ou les spécialités médicales ?';
            let suggestions = [];

            // Synonym mappings
            const synonyms = {
                'scanner': ['scanner', 'tomodensitomètre', 'ct'],
                'irm': ['irm', 'résonance magnétique', 'mri'],
                'ecg': ['électrocardiographe', 'ecg'],
                'eeg': ['électroencéphalographe', 'eeg'],
                'défib': ['défibrillateur', 'defibrillator'],
                'ventilateur': ['ventilateur', 'respirateur']
            };

            // Find matching device or service
            let contextDevice = chatHistory.length > 1 ? findDeviceByName(chatHistory[chatHistory.length - 2].query) : null;
            let matchedDevice = null;
            let matchedService = null;

            for (const serviceKey in services) {
                const service = services[serviceKey];
                if (normalizedQuery.includes(serviceKey) || normalizedQuery.includes(service.name.toLowerCase())) {
                    matchedService = serviceKey;
                    response = `${service.name} : ${service.description} Exemples de dispositifs : ${service.examples.join(', ')}.`;
                    suggestions = [
                        { text: 'Voir les dispositifs', query: `Dispositifs de ${service.name}` },
                        { text: 'En savoir plus', query: `Détails sur ${service.name}` }
                    ];
                    break;
                }
            }

            for (const serviceKey in devices) {
                const deviceList = devices[serviceKey];
                for (const device of deviceList) {
                    const deviceSynonyms = Object.keys(synonyms).find(key => synonyms[key].includes(device.name.toLowerCase())) || device.name.toLowerCase();
                    if (normalizedQuery.includes(device.name.toLowerCase()) || (deviceSynonyms && normalizedQuery.includes(deviceSynonyms))) {
                        matchedDevice = device;
                        response = `${device.name} (${serviceKey.charAt(0).toUpperCase() + serviceKey.slice(1)}) : \n- Rôle : ${device.role}\n- Principe : ${device.principle}\n- Composants : ${device.components.join(', ')}\n- Maintenance : ${device.maintenance.join(', ')}\n- Marques : ${device.brands.join(', ')}`;
                        suggestions = [
                            { text: 'Composants', query: `Composants de ${device.name}` },
                            { text: 'Maintenance', query: `Maintenance de ${device.name}` },
                            { text: 'Marques', query: `Marques de ${device.name}` }
                        ];
                        break;
                    }
                    if (normalizedQuery.includes('rôle') && (normalizedQuery.includes(device.name.toLowerCase()) || (contextDevice && contextDevice.name === device.name))) {
                        matchedDevice = device;
                        response = `Le rôle de ${device.name} est : ${device.role}`;
                        suggestions = [{ text: 'Principe', query: `Principe de ${device.name}` }];
                        break;
                    }
                    if (normalizedQuery.includes('principe') && (normalizedQuery.includes(device.name.toLowerCase()) || (contextDevice && contextDevice.name === device.name))) {
                        matchedDevice = device;
                        response = `Le principe de fonctionnement de ${device.name} est : ${device.principle}`;
                        suggestions = [{ text: 'Composants', query: `Composants de ${device.name}` }];
                        break;
                    }
                    if (normalizedQuery.includes('composants') && (normalizedQuery.includes(device.name.toLowerCase()) || (contextDevice && contextDevice.name === device.name))) {
                        matchedDevice = device;
                        response = `Les composants principaux de ${device.name} sont : ${device.components.join(', ')}`;
                        suggestions = [{ text: 'Maintenance', query: `Maintenance de ${device.name}` }];
                        break;
                    }
                    if (normalizedQuery.includes('maintenance') && (normalizedQuery.includes(device.name.toLowerCase()) || (contextDevice && contextDevice.name === device.name))) {
                        matchedDevice = device;
                        response = `La checklist pour la maintenance préventive de ${device.name} est : ${device.maintenance.join(', ')}`;
                        suggestions = [{ text: 'Marques', query: `Marques de ${device.name}` }];
                        break;
                    }
                    if (normalizedQuery.includes('marques') && (normalizedQuery.includes(device.name.toLowerCase()) || (contextDevice && contextDevice.name === device.name))) {
                        matchedDevice = device;
                        response = `Les marques associées à ${device.name} sont : ${device.brands.join(', ')}`;
                        suggestions = [{ text: 'Rôle', query: `Rôle de ${device.name}` }];
                        break;
                    }
                }
                if (matchedDevice) break;
            }

            // Handle comparison queries
            if (normalizedQuery.includes('comparer') || normalizedQuery.includes('compare')) {
                const deviceNames = Object.values(devices).flat().map(d => d.name.toLowerCase());
                const foundDevices = deviceNames.filter(name => normalizedQuery.includes(name));
                if (foundDevices.length >= 2) {
                    const device1 = findDeviceByName(foundDevices[0]);
                    const device2 = findDeviceByName(foundDevices[1]);
                    if (device1 && device2) {
                        response = `Comparaison entre ${device1.name} et ${device2.name} :\n` +
                            `- **Rôle** : ${device1.name} : ${device1.role} | ${device2.name} : ${device2.role}\n` +
                            `- **Principe** : ${device1.name} : ${device1.principle} | ${device2.name} : ${device2.principle}\n` +
                            `- **Marques** : ${device1.name} : ${device1.brands.join(', ')} | ${device2.name} : ${device2.brands.join(', ')}`;
                        suggestions = [
                            { text: `Composants de ${device1.name}`, query: `Composants de ${device1.name}` },
                            { text: `Composants de ${device2.name}`, query: `Composants de ${device2.name}` }
                        ];
                    }
                }
            }

            // Handle English queries
            if (/^(what is|what's|tell me about)/i.test(normalizedQuery)) {
                for (const serviceKey in devices) {
                    const deviceList = devices[serviceKey];
                    for (const device of deviceList) {
                        if (normalizedQuery.includes(device.name.toLowerCase()) || (synonyms[device.name.toLowerCase()] && synonyms[device.name.toLowerCase()].some(s => normalizedQuery.includes(s)))) {
                            matchedDevice = device;
                            response = `${device.name} (${serviceKey.charAt(0).toUpperCase() + serviceKey.slice(1)}) : \n- Rôle : ${device.role}\n- Principe : ${device.principle}\n- Composants : ${device.components.join(', ')}\n- Maintenance : ${device.maintenance.join(', ')}\n- Marques : ${device.brands.join(', ')}`;
                            suggestions = [
                                { text: 'Composants', query: `Composants de ${device.name}` },
                                { text: 'Maintenance', query: `Maintenance de ${device.name}` },
                                { text: 'Marques', query: `Marques de ${device.name}` }
                            ];
                            break;
                        }
                    }
                    if (matchedDevice) break;
                }
            }

            const allBrands = [...new Set(Object.values(devices).flat().flatMap(device => device.brands))];
            for (const brand of allBrands) {
                if (normalizedQuery.includes(brand.toLowerCase())) {
                    const devicesWithBrand = Object.values(devices).flat().filter(device => device.brands.includes(brand));
                    const deviceNames = devicesWithBrand.map(device => device.name);
                    response = `La marque ${brand} est associée aux dispositifs suivants : ${deviceNames.join(', ')}.`;
                    suggestions = deviceNames.slice(0, 2).map(name => ({ text: `Détails sur ${name}`, query: name }));
                    break;
                }
            }

            if (normalizedQuery.includes('spécialités') || normalizedQuery.includes('specialties')) {
                response = `MediTech propose des équipements pour les spécialités suivantes : ${Object.values(services).map(s => s.name).join(', ')}.`;
                suggestions = Object.keys(services).slice(0, 3).map(key => ({ text: services[key].name, query: services[key].name }));
            } else if (normalizedQuery.includes('dispositifs') || normalizedQuery.includes('devices')) {
                const allDevices = Object.values(devices).flat().map(d => d.name);
                response = `MediTech propose les dispositifs suivants : ${allDevices.join(', ')}.`;
                suggestions = allDevices.slice(0, 3).map(name => ({ text: `Détails sur ${name}`, query: name }));
            } else if (normalizedQuery.includes('marques') || normalizedQuery.includes('brands')) {
                response = `Les marques disponibles sur MediTech incluent : ${allBrands.join(', ')}.`;
                suggestions = allBrands.slice(0, 3).map(brand => ({ text: `Dispositifs de ${brand}`, query: brand }));
            }

            return { response, suggestions };
        }

        document.addEventListener('DOMContentLoaded', () => {
            const exploreServicesBtn = document.getElementById('exploreServicesBtn');
            if (exploreServicesBtn) {
                exploreServicesBtn.addEventListener('click', showServices);
            }

            const homeBackBtn = document.getElementById('homeBackBtn');
            if (homeBackBtn) {
                homeBackBtn.addEventListener('click', showHome);
            }

            const servicesBackBtn = document.getElementById('servicesBackBtn');
            if (servicesBackBtn) {
                servicesBackBtn.addEventListener('click', showServices);
            }

            const devicesBackBtn = document.getElementById('devicesBackBtn');
            if (devicesBackBtn) {
                devicesBackBtn.addEventListener('click', () => showDevices(currentService));
            }

            document.querySelectorAll('.service-card').forEach(card => {
                card.addEventListener('click', () => {
                    const service = card.getAttribute('data-service');
                    if (service) {
                        showDevices(service);
                    }
                });
            });

            const searchBox = document.getElementById('searchBox');
            if (searchBox) {
                searchBox.addEventListener('input', (e) => {
                    const searchTerm = e.target.value.toLowerCase();
                    const devicesGrid = document.getElementById('devicesGrid');
                    if (!devicesGrid) return;
                    devicesGrid.innerHTML = '';

                    if (currentService && devices[currentService]) {
                        const filteredDevices = devices[currentService].filter(device =>
                            device.name.toLowerCase().includes(searchTerm) ||
                            device.role.toLowerCase().includes(searchTerm)
                        );
                        if (filteredDevices.length > 0) {
                            const fragment = document.createDocumentFragment();
                            sortDevices(filteredDevices).forEach(device => {
                                const card = createDeviceCard(device);
                                fragment.appendChild(card);
                            });
                            devicesGrid.appendChild(fragment);
                        } else {
                            devicesGrid.innerHTML = '<p class="image-error">Aucun dispositif trouvé pour cette spécialité.</p>';
                        }
                    }
                });
            }

            const sortSelect = document.getElementById('sortSelect');
            if (sortSelect) {
                sortSelect.addEventListener('change', () => {
                    if (currentService) {
                        showDevices(currentService);
                    }
                });
            }

            const chatbotToggle = document.getElementById('chatbotToggle');
            const chatbotContainer = document.getElementById('chatbotContainer');
            const chatbotClose = document.getElementById('chatbotClose');
            const chatbotSend = document.getElementById('chatbotSend');
            const chatbotInput = document.getElementById('chatbotInput');

            if (chatbotToggle && chatbotContainer && chatbotClose && chatbotSend && chatbotInput) {
                chatbotToggle.addEventListener('click', () => {
                    chatbotContainer.style.display = chatbotContainer.style.display === 'block' ? 'none' : 'block';
                    if (chatbotContainer.style.display === 'block') {
                        chatbotInput.focus();
                        chatHistory = [];
                        addChatMessage('Bonjour ! Je suis MediTech Assistant. Posez-moi une question sur les dispositifs, les marques ou les spécialités médicales.', false, [
                            { text: 'Liste des spécialités', query: 'Spécialités' },
                            { text: 'Liste des dispositifs', query: 'Dispositifs' }
                        ]);
                    }
                });

                chatbotClose.addEventListener('click', () => {
                    chatbotContainer.style.display = 'none';
                    chatHistory = [];
                });

                chatbotSend.addEventListener('click', () => {
                    const query = chatbotInput.value.trim();
                    if (query) {
                        addChatMessage(query, true);
                        showTypingAnimation(true);
                        setTimeout(() => {
                            const { response, suggestions } = processChatbotQuery(query);
                            showTypingAnimation(false);
                            addChatMessage(response, false, suggestions);
                            chatbotInput.value = '';
                        }, 1000);
                    }
                });

                chatbotInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter' && chatbotInput.value.trim()) {
                        chatbotSend.click();
                    }
                });
            }

            showHome();
        });
    </script>
</body>
</html>